"use strict";(self.webpackChunkchaoticbackup=self.webpackChunkchaoticbackup||[]).push([[592],{58660:(e,i,r)=>{r.d(i,{Z:()=>a});var n=r(3050),t=r.n(n),s=r(42196);function g(e,i){if(void 0===i&&(i=!0),e=e.replace(/\‘|\’/g,"'"),!0===i){if(/[\^$+*\[\]|]/g.test(e))try{return new RegExp(e,"i")}catch(e){}}return e=e.replace(/[\^$+*\[\]\\]/g,"").replace(/[\(\)]/g,(function(e){return console.log(e),"\\"+e})),new RegExp(e,"i")}function a(e){var i,r,n,a,$=new(t())("filter.db").addCollection("filter"),x=$.addDynamicView("filter");x.applySimpleSort("gsx$name");var f,l=s.Z.cards.attacks.chain(),o=s.Z.cards.battlegear.chain(),c=s.Z.cards.creatures.chain(),d=s.Z.cards.locations.chain(),u=s.Z.cards.mugic.chain();if(l=l.where((function(e){return""!=e.gsx$set})),o=o.where((function(e){return""!=e.gsx$set})),c=c.where((function(e){return""!=e.gsx$set})),d=d.where((function(e){return""!=e.gsx$set})),u=u.where((function(e){return""!=e.gsx$set})),e.name.length>0){var m=[],p=e.name.replace(/(?:~)([\w,()]+)/g,(function(e,i){return m.push(i),""}));if(p.length>0&&(p=g(p),l=l.find({$or:[{gsx$name:{$regex:p}},{gsx$tags:{$regex:p}}]}),o=o.find({$or:[{gsx$name:{$regex:p}},{gsx$tags:{$regex:p}}]}),c=c.find({$or:[{gsx$name:{$regex:p}},{gsx$tags:{$regex:p}}]}),d=d.find({$or:[{gsx$name:{$regex:p}},{gsx$tags:{$regex:p}}]}),u=u.find({$or:[{gsx$name:{$regex:p}},{gsx$tags:{$regex:p}}]})),m.length>0){var h=function(e){var i=!1;return m.forEach((function(r){i|=e.gsx$name.toLowerCase().indexOf(r.toLowerCase().replace("_"," "))>-1})),!i};l=l.where(h),o=o.where(h),c=c.where(h),d=d.where(h),u=u.where(h)}}if(e.text.length>0){var w=[],v=e.text.replace(/(?:~)(\w+)/g,(function(e,i){return w.push(i),""}));if(v.length>0){v=g(v);var y=(f=[{gsx$tags:{$regex:v}},{gsx$ability:{$regex:v}}],e.flavor&&(f.push({gsx$flavortext:{$regex:v}}),f.push({gsx$artist:{$regex:v}})),f);l=l.find({$or:y}),o=o.find({$or:y}),c=c.find({$or:y.concat([{gsx$brainwashed:{$regex:v}}])}),d=d.find({$or:y}),u=u.find({$or:y})}if(w.length>0){var b=function(e,i){void 0===i&&(i=!1);var r=!1;return w.forEach((function(n){r|=e.gsx$ability.toLowerCase().indexOf(n.toLowerCase())>-1,r|=e.gsx$flavortext.toLowerCase().indexOf(n.toLowerCase())>-1,i&&(r|=e.gsx$brainwashed.toLowerCase().indexOf(n.toLowerCase())>-1)})),!r};l=l.where(b),o=o.where(b),c=c.where((function(e){return b(e,!0)})),d=d.where(b),u=u.where(b)}}if(e.subtypes.length>0){var k=e.subtypes.split(",").filter(Boolean).map((function(e){return{$regex:g(e,!1)}}));c=c.find({gsx$types:{$or:k}}),d=d.find({$or:[{gsx$initiative:{$or:k}},{gsx$types:{$or:k}}]}),l=l.limit(0),o=o.find({gsx$types:{$or:k}}),u=u.limit(0)}var E=[];for(var C in e.tribes)e.tribes[C]&&E.push({$regex:new RegExp(C,"i")});if(E.length>0&&(c=c.find({gsx$tribe:{$or:E}}),u=u.find({gsx$tribe:{$or:E}}),l=l.limit(0),o=o.limit(0),d=d.limit(0)),e.elements.none){var q=e.elements,L=q.fire,R=q.air,O=q.earth,Z=q.water;if(e.elements.and){l=l.where((function(e){return L?""!=e.gsx$fire:""==e.gsx$fire})).where((function(e){return R?""!=e.gsx$air:""==e.gsx$air})).where((function(e){return O?""!=e.gsx$earth:""==e.gsx$earth})).where((function(e){return Z?""!=e.gsx$water:""==e.gsx$water}));var j=["fire","air","earth","water"].filter((function(i){return e.elements[i]})).join(", ");""!==j&&(c=c.find({gsx$elements:{$regex:new RegExp("^"+j+"s*$","i")}}))}else if(L||R||O||Z){L&&(l=l.where((function(e){return""==e.gsx$fire}))),R&&(l=l.where((function(e){return""==e.gsx$air}))),O&&(l=l.where((function(e){return""==e.gsx$earth}))),Z&&(l=l.where((function(e){return""==e.gsx$water})));var U=["fire","air","earth","water"].reduce((function(i,r){return i+(e.elements[r]?"(?!"+r+")":"")}),"");c=c.find({gsx$elements:{$regex:new RegExp("^("+U+".)*$","i")}})}else l=l.where((function(e){return""==e.gsx$fire})).where((function(e){return""==e.gsx$air})).where((function(e){return""==e.gsx$earth})).where((function(e){return""==e.gsx$water})),c=c.where((function(e){return""==e.gsx$elements}));o=o.limit(0),d=d.limit(0),u=u.limit(0)}else{var S=[],A=[];for(var B in e.elements){var D;if("none"!==B&&"and"!==B)if(e.elements[B])S.push({$regex:new RegExp(B,"i")}),A.push(((D={})["gsx$"+B]={$gte:0},D))}S.length>0&&(e.elements.and?(c=c.find({gsx$elements:{$and:S}}),l=l.find({$and:A})):(c=c.find({gsx$elements:{$or:S}}),l=l.find({$or:A})),o=o.limit(0),d=d.limit(0),u=u.limit(0))}var V=e.disciplines.max&&e.disciplines.max?"$lte":"$gte";e.disciplines.courage>0&&(c=c.find({gsx$courage:(i={},i[V]=e.disciplines.courage,i)})),e.disciplines.power>0&&(c=c.find({gsx$power:(r={},r[V]=e.disciplines.power,r)})),e.disciplines.wisdom>0&&(c=c.find({gsx$wisdom:(n={},n[V]=e.disciplines.wisdom,n)})),e.disciplines.speed>0&&(c=c.find({gsx$speed:(a={},a[V]=e.disciplines.speed,a)})),e.energy.min>0&&(c=c.find({gsx$energy:{$gte:e.energy.min}})),e.energy.max>0&&e.energy.max>=e.energy.min&&(c=c.find({gsx$energy:{$lte:e.energy.max}})),(e.energy.min>0||e.energy.max>0||e.disciplines.courage>0||e.disciplines.power>0||e.disciplines.wisdom>0||e.disciplines.speed>0)&&(l=l.limit(0),o=o.limit(0),d=d.limit(0),u=u.limit(0)),""!==e.mcbp.min&&e.mcbp.min>=0&&(l=l.find({gsx$bp:{$gte:e.mcbp.min}}),c=c.find({gsx$mugicability:{$gte:e.mcbp.min}}),u=u.find({gsx$cost:{$gte:e.mcbp.min}})),""!==e.mcbp.max&&e.mcbp.max>=0&&e.mcbp.max>=e.mcbp.min&&(l=l.find({gsx$bp:{$lte:e.mcbp.max}}),c=c.find({gsx$mugicability:{$lte:e.mcbp.max}}),u=u.find({gsx$cost:{$lte:e.mcbp.max}})),(e.mcbp.max>0||e.mcbp.min>0)&&(o=o.limit(0),d=d.limit(0)),e.mull.unique&&(l=l.find({gsx$unique:{$gt:0}}),o=o.find({gsx$unique:{$gt:0}}),c=c.find({gsx$unique:{$gt:0}}),d=d.find({gsx$unique:{$gt:0}}),u=u.find({gsx$unique:{$gt:0}})),e.mull.loyal&&(l=l.limit(0),o=o.find({gsx$loyal:{$gt:0}}),c=c.find({gsx$loyal:{$gt:0}}),u=u.limit(0),d=d.limit(0)),e.mull.legendary&&(l=l.find({gsx$legendary:{$gt:0}}),o=o.find({gsx$legendary:{$gt:0}}),c=c.find({gsx$legendary:{$gt:0}}),d=d.find({gsx$legendary:{$gt:0}}),u=u.find({gsx$legendary:{$gt:0}})),e.mull.mixed&&(c=c.find({gsx$loyal:{$lte:0}}),o=o.find({gsx$loyal:{$lte:0}}));var _=[];for(var z in e.sets)e.sets[z]&&_.push({$eq:z.toUpperCase()});if(0===_.length){var F=Object.keys(e.sets);for(var G in e.sets.proto||0!==e.name.length||F.splice(F.indexOf("proto")),F)_.push({$eq:F[G].toUpperCase()})}_.length>0&&(l=l.find({gsx$set:{$or:_}}),o=o.find({gsx$set:{$or:_}}),c=c.find({gsx$set:{$or:_}}),d=d.find({gsx$set:{$or:_}}),u=u.find({gsx$set:{$or:_}}));var H=[];for(var I in e.rarity)e.rarity[I]&&H.push({$eq:I.split(" ").map((function(e){return e.charAt(0).toUpperCase()+e.slice(1)})).join(" ")});if(H.length>0&&(l=l.find({gsx$rarity:{$or:H}}),o=o.find({gsx$rarity:{$or:H}}),c=c.find({gsx$rarity:{$or:H}}),d=d.find({gsx$rarity:{$or:H}}),u=u.find({gsx$rarity:{$or:H}})),e.exclusive.starter){var J=new RegExp("starter","i");l=l.find({gsx$exclusive:{$regex:J}}),o=o.find({gsx$exclusive:{$regex:J}}),c=c.find({gsx$exclusive:{$regex:J}}),d=d.find({gsx$exclusive:{$regex:J}}),u=u.find({gsx$exclusive:{$regex:J}})}if(e.exclusive.online){var K=new RegExp("online","i");l=l.find({gsx$exclusive:{$regex:K}}),o=o.find({gsx$exclusive:{$regex:K}}),c=c.find({gsx$exclusive:{$regex:K}}),d=d.find({gsx$exclusive:{$regex:K}}),u=u.find({gsx$exclusive:{$regex:K}})}var M=!(e.types.attack|e.types.battlegear|e.types.creature|e.types.location|e.types.mugic);if(M||e.types.attack){var N=l.data();N.forEach((function(e){delete e.$loki})),$.insert(N)}if(M||e.types.battlegear){var P=o.data();P.forEach((function(e){delete e.$loki})),$.insert(P)}if(M||e.types.creature){var Q=c.data();Q.forEach((function(e){delete e.$loki})),$.insert(Q)}if(M||e.types.location){var T=d.data();T.forEach((function(e){delete e.$loki})),$.insert(T)}if(M||e.types.mugic){var W=u.data();W.forEach((function(e){delete e.$loki})),$.insert(W)}return x.data()}}}]);